!function webpackUniversalModuleDefinition(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.plugsy=factory():root.plugsy=factory()}(window,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _utils_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_decorators_command__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);__webpack_require__.d(__webpack_exports__,"command",function(){return _decorators_command__WEBPACK_IMPORTED_MODULE_1__.default});var _decorators_persist__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3);__webpack_require__.d(__webpack_exports__,"persist",function(){return _decorators_persist__WEBPACK_IMPORTED_MODULE_2__.default});var _lib_Plugsy__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),_lib_PlugsyManager__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5);__webpack_require__.d(__webpack_exports__,"PlugsyManager",function(){return _lib_PlugsyManager__WEBPACK_IMPORTED_MODULE_4__.default});var _utils_loader__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(34);__webpack_require__.d(__webpack_exports__,"loader",function(){return _utils_loader__WEBPACK_IMPORTED_MODULE_5__.default});var _utils_shimmer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8);__webpack_require__.d(__webpack_exports__,"shimmer",function(){return _utils_shimmer__WEBPACK_IMPORTED_MODULE_6__.default});var _utils_tagger__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9);if(__webpack_require__.d(__webpack_exports__,"tagger",function(){return _utils_tagger__WEBPACK_IMPORTED_MODULE_7__.default}),_utils_constants__WEBPACK_IMPORTED_MODULE_0__.hasWindow){const w=window;w.corescript?w.corescript.$.plugsy=new _lib_PlugsyManager__WEBPACK_IMPORTED_MODULE_4__.default:w.$plugsy=new _lib_PlugsyManager__WEBPACK_IMPORTED_MODULE_4__.default}__webpack_exports__.default=_lib_Plugsy__WEBPACK_IMPORTED_MODULE_3__.default},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"isCommand",function(){return isCommand}),__webpack_require__.d(__webpack_exports__,"toPersist",function(){return toPersist}),__webpack_require__.d(__webpack_exports__,"shimmedFn",function(){return shimmedFn}),__webpack_require__.d(__webpack_exports__,"persisted",function(){return persisted}),__webpack_require__.d(__webpack_exports__,"hasWindow",function(){return hasWindow});const isCommand="$$plugsy.isCommand$$",toPersist="$$plugsy.toPersist$$",shimmedFn="$$plugsy.shimmedFn$$",persisted="$$plugsy.isPersisted$$",hasWindow="undefined"!=typeof window},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _utils_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);function brand(object){Object.defineProperty(object,_utils_constants__WEBPACK_IMPORTED_MODULE_0__.isCommand,{value:!0})}__webpack_exports__.default=function command(target,key){return"function"==typeof target?(brand(target),target):void brand(target[key])}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"brand",function(){return brand});var _utils_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);function brand(object){const o=new Object(object);return object&&!object[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]&&(Object.defineProperty(o,_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist,{value:!0}),Object.defineProperty(o,_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted,{value:object})),o}__webpack_exports__.default=function persist(value,key){if(!key)return brand(value);value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]=value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]?value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist].concat(key):[key]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return Plugsy});var _a,_utils_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);class Plugsy{constructor(){this[_a]={},this.data=[]}uninstall(){}install(){const keys=this[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]||[];for(const key in this)if(key in this){const value=this[key];value&&value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]&&-1===keys.indexOf(key)&&keys.push(key)}for(const key of keys){const value=this[key];this[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted][key]=value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted]?value[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted]:value,Object.defineProperty(this,key,{get:()=>this[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted][key],set:v=>this[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted][key]=v})}this[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]=keys}}_a=_utils_constants__WEBPACK_IMPORTED_MODULE_0__.persisted},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return PlugsyManager});var _utils_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_utils_hydrate__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_utils_persist__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7),_utils_shimmer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8),_utils_tagger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};const hasCorescript=_utils_constants__WEBPACK_IMPORTED_MODULE_0__.hasWindow&&window.corescript,corescript=hasCorescript?window.corescript:null;class PlugsyManager{constructor(){this.commands=[],this.ctors={},this.plugins={},this.handles={},this.notetags={},this.data=[],this.store={},this.shim()}shim(){const Data=hasCorescript?corescript.Managers.DataManager:DataManager;Object(_utils_shimmer__WEBPACK_IMPORTED_MODULE_3__.default)(Data,{extractSaveContents:(dm,extractSave,contents)=>__awaiter(this,void 0,void 0,function*(){yield this._uninstallPlugins(),this.store={},this._load(contents.plugsy),extractSave(contents),yield this._installPlugins()}),setupNewGame:(dm,setup)=>__awaiter(this,void 0,void 0,function*(){this.store={},yield this._uninstallPlugins(),this._load({}),setup(),yield this._installPlugins()}),isDatabaseLoaded:(dm,isLoaded)=>__awaiter(this,void 0,void 0,function*(){const okay=isLoaded(),reduce=(p,curr)=>__awaiter(this,void 0,void 0,function*(){const prev=yield p;return Object.assign({},prev,{[curr.id]:yield Object(_utils_tagger__WEBPACK_IMPORTED_MODULE_4__.default)(curr.note)})});return this.notetags=yield hasCorescript?Object.keys(corescript.$).filter(f=>Array.isArray(corescript.$[f])).reduce((p,f)=>__awaiter(this,void 0,void 0,function*(){const a=yield p;return Object.assign({},a,{[f]:yield(corescript.$[f]||[]).filter(i=>i&&i.note).reduce(reduce,{})})}),{}):Object.keys(window).filter(k=>k.startsWith("$")).filter(k=>Array.isArray(window[k])).reduce((p,k)=>__awaiter(this,void 0,void 0,function*(){const a=yield p;return Object.assign({},a,{[k]:yield(window[k]||[]).filter(i=>i&&i.note).reduce(reduce,{})})}),{}),okay}),loadDatabase:(dm,load)=>{dm._databaseFiles.push(...this.data),load()},makeSaveContents:(dm,makeSave)=>{const contents=makeSave();return contents.plugsy=this._save(),contents}})}install(plugin){return this.ctors[plugin.name]=plugin,this}_save(){const out={};for(const name in this.plugins)if(this.plugins[name]){const plugin=this.plugins[name];out[name]=Object(_utils_persist__WEBPACK_IMPORTED_MODULE_2__.default)(plugin)}return out}_load(contents){for(const name in contents)contents[name]&&(this.store[name]=contents[name])}_uninstallPlugins(){return __awaiter(this,void 0,void 0,function*(){for(const key of Object.keys(this.plugins))this.commands=this.commands.filter(command=>!command.startsWith(key)),yield this._uninstall(key)})}_hydrate(name,plugin){Object(_utils_hydrate__WEBPACK_IMPORTED_MODULE_1__.default)(plugin,this.store[name]||{})}_installPlugins(){return __awaiter(this,void 0,void 0,function*(){for(const key of Object.keys(this.ctors))if(!this.plugins[key]){const plugin=new(0,this.ctors[key]);this.data.push(...plugin.data),yield this._install(plugin),this.plugins[key]=plugin}})}_uninstall(name){return __awaiter(this,void 0,void 0,function*(){const plugin=this.plugins[name];yield plugin.uninstall();const id=this.handles[name],Interpreter=hasCorescript?corescript.Game.Game_Interpreter:Game_Interpreter;Object(_utils_shimmer__WEBPACK_IMPORTED_MODULE_3__.default)(Interpreter,id),delete this.plugins[name]})}_install(plugin){return __awaiter(this,void 0,void 0,function*(){const name=plugin.constructor.name;this._hydrate(name,plugin),yield plugin.install(),plugin.parameters=PluginManager.parameters(name),this.plugins[name]=plugin;for(const key of Object.getOwnPropertyNames(Object.getPrototypeOf(plugin)))plugin[key][_utils_constants__WEBPACK_IMPORTED_MODULE_0__.isCommand]&&this.commands.push(`${name.toLowerCase()} ${key.toLowerCase()}`);const Interpreter=hasCorescript?corescript.Game.Game_Interpreter:Game_Interpreter,handle=Object(_utils_shimmer__WEBPACK_IMPORTED_MODULE_3__.default)(Interpreter.prototype,{pluginCommand(int,fn,command,args){fn(command,args);const subcommand=args[0];if(command.toLowerCase()===name.toLowerCase()){const cmd=plugin[subcommand];cmd&&cmd[_utils_constants__WEBPACK_IMPORTED_MODULE_0__.isCommand]&&cmd.apply(plugin,args.slice(1))}}});this.handles[name]=handle})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";function merge(target,persisted){for(const key of Object.keys(persisted))target[key]=persisted[key];return target}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return merge})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return serialize});var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);function serialize(obj){const out={};for(const key of obj[_constants__WEBPACK_IMPORTED_MODULE_0__.toPersist]||[])out[key]=obj[key];return out}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"unshim",function(){return unshim}),__webpack_require__.d(__webpack_exports__,"shim",function(){return shim});var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);let shimId=1;function unshim(fn,index){fn[_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn].splice(index,1)}function shim(object,key,fn){const original=object[key],id=shimId,shims=original[_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn]?original[_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn]:{0:original};shims[id]=((obj,prev,...args)=>prev?fn.call(obj,obj,prev,...args):fn.apply(obj,args));const wrap=(ctx,curr,prev)=>(...args)=>curr(ctx,prev,...args);return Object.assign(object,{[key]:Object.assign(function(...args){const all=this[key][_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn],fns=Object.keys(all).map(k=>all[k].bind(this));let res=fns.shift();for(;fns.length;){const curr=fns.shift(),prev=res;res=((...moreArgs)=>wrap(this,curr,prev)(...moreArgs))}return res(...args)},{[_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn]:shims})})}__webpack_exports__.default=function shimmer(obj,methods){if("number"==typeof methods)for(const key in obj)obj[key]&&obj[key][_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn]&&delete obj[key][_constants__WEBPACK_IMPORTED_MODULE_0__.shimmedFn][methods];else for(const key in methods)key in methods&&(obj=shim(obj,key,methods[key]));return shimId++}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return tagger});var tsxml__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};function tagger(note){return __awaiter(this,void 0,void 0,function*(){if("string"!=typeof note)return null;const filtered=note.split("\n").map(line=>line.replace(/<(.*):[^\/](.+)>/,"")).join("\n");return(yield tsxml__WEBPACK_IMPORTED_MODULE_0__.Parser.parseStringToAst(filtered)).childNodes.map(child=>(function parseAst(node){if(node){const out={};if(node.content)return node.content;if(node.attrList)for(const attr in node.attrList)if(attr in node.attrList){const cased=attr.replace(/^([A-Z])|[\s-_]+(\w)/g,(_,p1,p2)=>p2?p2.toUpperCase():p1.toLowerCase()),v=node.attrList[attr];out[cased]=void 0===v||v}if(node.childNodes){const children=node.childNodes.map(n=>parseAst(n));if(children.length>=1&&(out.children=children),1===children.length){const first=children[0];"string"==typeof first&&(out.contents=first,delete out.children)}}return node.tagName?{[node.tagName]:out}:out}return null})(child)).filter(t=>"string"!=typeof t).reduce((a,b)=>Object.assign({},a,b),{})})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const ast=__webpack_require__(11);exports.ast=ast;const parser=__webpack_require__(24);exports.parser=parser;const SyntaxErrorCode_1=__webpack_require__(25);exports.SyntaxErrorCode=SyntaxErrorCode_1.SyntaxErrorCode;const SyntaxError_1=__webpack_require__(26);exports.SyntaxError=SyntaxError_1.SyntaxError;const Parser_1=__webpack_require__(30);exports.Parser=Parser_1.Parser;const Compiler_1=__webpack_require__(33);exports.Compiler=Compiler_1.Compiler},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Attribute_1=__webpack_require__(12);exports.Attribute=Attribute_1.Attribute;const Node_1=__webpack_require__(13);exports.Node=Node_1.Node;const SelfClosingNode_1=__webpack_require__(15);exports.SelfClosingNode=SelfClosingNode_1.SelfClosingNode;const VoidNode_1=__webpack_require__(16);exports.VoidNode=VoidNode_1.VoidNode;const TextNode_1=__webpack_require__(17);exports.TextNode=TextNode_1.TextNode;const CommentNode_1=__webpack_require__(18);exports.CommentNode=CommentNode_1.CommentNode;const CDataSectionNode_1=__webpack_require__(19);exports.CDataSectionNode=CDataSectionNode_1.CDataSectionNode;const DeclarationOpenerNode_1=__webpack_require__(20);exports.DeclarationOpenerNode=DeclarationOpenerNode_1.DeclarationOpenerNode;const ProcessingInstructionNode_1=__webpack_require__(21);exports.ProcessingInstructionNode=ProcessingInstructionNode_1.ProcessingInstructionNode;const ContainerNode_1=__webpack_require__(22);exports.ContainerNode=ContainerNode_1.ContainerNode;const DocumentNode_1=__webpack_require__(23);exports.DocumentNode=DocumentNode_1.DocumentNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Attribute{static create(value){return new class extends Attribute{constructor(){super(...arguments),this.value=value}}}valueOf(){return this.value}toString(){return this.value+""}}exports.Attribute=Attribute},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const NodeFlags_1=__webpack_require__(14);class Node{constructor(){this.parserFlags=NodeFlags_1.NodeFlags.None,this.attrList={},this.applyAttributePropertyBindings()}static get defaultStringificationParams(){return{attrParen:'"',indentChar:"\t",newlineChar:"\n"}}get parentNode(){return this._parentNode}getAllAttributeNames(){return Object.keys(this.attrList)}getNumberOfAttributes(){return this.getAllAttributeNames().length}hasAttribute(attrName){return-1!==this.getAllAttributeNames().indexOf(attrName)}getAttribute(attrName,namespaceName){if("object"==typeof this.attrList&&null!==this.attrList)return attrName=Node.joinAttributeNameWithNamespacePrefix(attrName,namespaceName),this.attrList[attrName]}setAttribute(attrName,value,namespaceName){return attrName=Node.joinAttributeNameWithNamespacePrefix(attrName,namespaceName),this.attrList=this.attrList||{},this.attrList[attrName]=value,this}removeAttribute(attrName,namespaceName){return attrName=Node.joinAttributeNameWithNamespacePrefix(attrName,namespaceName),delete this.attrList[attrName],this}toFormattedString(stringificationParams){return stringificationParams="object"==typeof stringificationParams&&null!==stringificationParams?Node.mergeObjects(Node.defaultStringificationParams,stringificationParams):Node.defaultStringificationParams,this.stringify(stringificationParams)}toString(){return this.stringify({indentChar:"",newlineChar:"",attrParen:'"'})}isTagNameAndNamespaceIdenticalTo(otherNode){return this.namespacePrefix===otherNode.namespacePrefix&&this.tagName===otherNode.tagName}isAttributeListIdenticalTo(otherNode){if(this.getNumberOfAttributes()!==otherNode.getNumberOfAttributes())return!1;return-1===this.getAllAttributeNames().findIndex(attrName=>this.getAttribute(attrName)!==otherNode.getAttribute(attrName))}isIdenticalTo(otherNode){return this.constructor===otherNode.constructor&&this.isTagNameAndNamespaceIdenticalTo(otherNode)&&this.isAttributeListIdenticalTo(otherNode)}static attributePropertyBinding(attributeName){return(target,propertyName)=>{target.addAttributeProxyProperty(propertyName,attributeName)}}getBoundAttributeNameForProperty(propertyName){if("object"==typeof this.attrPropertyBindings&&null!==this.attrPropertyBindings)return this.attrPropertyBindings[propertyName]}getBoundPropertyNamesForAttribute(attributeName){const propertyNames=[];if("object"!=typeof this.attrPropertyBindings||null===this.attrPropertyBindings)return propertyNames;for(let propertyName in this.attrPropertyBindings)this.attrPropertyBindings[propertyName]===attributeName&&propertyNames.push(propertyName);return propertyNames}static joinAttributeNameWithNamespacePrefix(attrName,namespaceName){return void 0!==namespaceName&&(attrName=namespaceName+":"+attrName),attrName}static changeParentNode(childNode,newParentNode){childNode._parentNode=newParentNode}static removeParentNode(childNode){childNode._parentNode=void 0}static generateIndentString(indentChar,indentDepth){if(0===(indentDepth=Math.max(indentDepth||0,0)))return"";let indentString="";for(;indentDepth-- >0;)indentString+=indentChar;return indentString}stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),`${Node.generateIndentString(params.indentChar,nodeIndentDepth)}<${this.tagName}${this.stringifyAttributes(nodeIndentDepth)} />${params.newlineChar}`}stringifyAttributes(nodeIndentDepth){var attrString="";for(let attrName in this.attrList)attrString+=this.stringifyAttribute(attrName,this.attrList[attrName]);return attrString}stringifyAttribute(attrName,attrValue){return void 0!==attrValue?` ${attrName}="${attrValue}"`:` ${attrName}`}static mergeObjects(baseObject,overlayObject){for(let key in overlayObject)baseObject[key]=overlayObject[key];return baseObject}addAttributeProxyProperty(propertyName,attrName){this.attrPropertyBindings=this.attrPropertyBindings||{},this.attrPropertyBindings[propertyName]=attrName}applyAttributePropertyBindings(){if("object"==typeof this.attrPropertyBindings&&null!==this.attrPropertyBindings)for(let propertyName in this.attrPropertyBindings)this.applyAttributePropertyBinding(propertyName,this.attrPropertyBindings[propertyName])}applyAttributePropertyBinding(propertyName,attributeName){const value=this[propertyName];Object.defineProperty(this,propertyName,{get:()=>this.getAttribute(attributeName),set:newValue=>this.setAttribute(attributeName,newValue)}),this.setAttribute(attributeName,value)}}exports.Node=Node},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(NodeFlags){NodeFlags[NodeFlags.None=0]="None",NodeFlags[NodeFlags.Opened=1]="Opened",NodeFlags[NodeFlags.Closed=2]="Closed",NodeFlags[NodeFlags.SelfClosing=7]="SelfClosing",NodeFlags[NodeFlags.Void=15]="Void"}(exports.NodeFlags||(exports.NodeFlags={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);exports.SelfClosingNode=class SelfClosingNode extends Node_1.Node{}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);exports.VoidNode=class VoidNode extends Node_1.Node{stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),`${Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)}<${this.tagName}${this.stringifyAttributes(nodeIndentDepth)}>${params.newlineChar}`}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);class TextNode extends Node_1.Node{getContentLines(){return"string"!=typeof this.content||this.content.length<1?[]:this.content.trim().split(/\r?\n/)}isContentMultiLine(){return/\r?\n/.test(this.content.trim())}isContentIdenticalTo(otherNode){return TextNode.makeContentStringComparable(this.content||"")===TextNode.makeContentStringComparable(otherNode.content||"")}isIdenticalTo(otherNode){return super.isIdenticalTo(otherNode)&&this.isContentIdenticalTo(otherNode)}static makeContentStringComparable(contentString){return contentString.trim().replace(/[\t\r\n ]+/g,"").replace(/ +/g," ")}stringify(params,nodeIndentDepth){return this.stringifyContent(params,nodeIndentDepth)}stringifyContent(params,nodeIndentDepth){return this.isContentMultiLine()?this.stringifyMultiLineContent(params,nodeIndentDepth):this.stringifySingleLineContent(params,nodeIndentDepth)}stringifyMultiLineContent(params,nodeIndentDepth){var stringifiedContent="",newlineChar=params.newlineChar;return/\n/.test(params.newlineChar)||(newlineChar=" "),stringifiedContent+=this.getContentLines().map(contentLine=>Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)+contentLine.trim()).join(newlineChar),/\n/.test(params.newlineChar)?stringifiedContent+params.newlineChar:stringifiedContent}stringifySingleLineContent(params,nodeIndentDepth){const formattedContent=(this.content||"").trim().replace(/(\r?\n(\t*))+/g," ").trim();return/\n/.test(params.newlineChar)?Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)+formattedContent+"\n":formattedContent}}exports.TextNode=TextNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const TextNode_1=__webpack_require__(17);class CommentNode extends TextNode_1.TextNode{stringify(params,nodeIndentDepth){return`${CommentNode.generateIndentString(params.indentChar,nodeIndentDepth)}\x3c!--${this.stringifyContent(params,nodeIndentDepth)}--\x3e${params.newlineChar}`}stringifyMultiLineContent(params,nodeIndentDepth){return/\n/.test(params.newlineChar)?"\n"+super.stringifyMultiLineContent(params,nodeIndentDepth)+CommentNode.generateIndentString(params.indentChar,nodeIndentDepth):" "+super.stringifyMultiLineContent(params,nodeIndentDepth)+" "}stringifySingleLineContent(params,nodeIndentDepth){return" "+(this.content||"").trim().replace(/(\r?\n(\t*))+/g," ").trim()+" "}}exports.CommentNode=CommentNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const TextNode_1=__webpack_require__(17);class CDataSectionNode extends TextNode_1.TextNode{stringify(params,nodeIndentDepth){return`${CDataSectionNode.generateIndentString(params.indentChar,nodeIndentDepth)}<![CDATA[${this.stringifyContent(params,nodeIndentDepth)}]]>${params.newlineChar}`}stringifyMultiLineContent(params,nodeIndentDepth){return/\n/.test(params.newlineChar)?"\n"+super.stringifyMultiLineContent(params,nodeIndentDepth)+CDataSectionNode.generateIndentString(params.indentChar,nodeIndentDepth):super.stringifyMultiLineContent(params,nodeIndentDepth)}stringifySingleLineContent(params,nodeIndentDepth){return(this.content||"").replace(/(\r?\n(\t*))+/g," ")}}exports.CDataSectionNode=CDataSectionNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);exports.DeclarationOpenerNode=class DeclarationOpenerNode extends Node_1.Node{constructor(){super(...arguments),this.systemLiterals=[],this.literalAndAttrOrder=[]}getNumberOfSystemLiterals(){return this.systemLiterals.length}getIndexOfSystemLiteral(literal){return this.systemLiterals.indexOf(literal)}getSystemLiteralAtIndex(literalIndex){return this.systemLiterals[literalIndex]}getAllSystemLiterals(){return[].concat(this.systemLiterals)}hasSystemLiteral(literal){return-1!==this.getIndexOfSystemLiteral(literal)}insertIntoSystemLiteralList(literal,index){return this.appendSystemLiteralIndexToOrderList(index),this.systemLiterals.splice(index,0,literal),this}prependToSystemLiteralList(literal){return this.insertIntoSystemLiteralList(literal,0),this}appendToSystemLiteralList(literal){return this.insertIntoSystemLiteralList(literal,this.getNumberOfSystemLiterals()),this}removeSystemLiteralAtIndex(index){return this.removeSystemLiteralIndexFromOrderList(index),this.systemLiterals.splice(index,1),this}removeSystemLiteral(literal){let index=this.getIndexOfSystemLiteral(literal);for(;-1!==index;)this.systemLiterals.splice(index,1),index=this.getIndexOfSystemLiteral(literal);return this}setAttribute(attrName,value,namespaceName){return this.appendAttributeToOrderList(Node_1.Node.joinAttributeNameWithNamespacePrefix(attrName,namespaceName)),super.setAttribute(attrName,value,namespaceName),this}removeAttribute(attrName,namespaceName){return this.removeAttributeFromOrderList(Node_1.Node.joinAttributeNameWithNamespacePrefix(attrName,namespaceName)),super.removeAttribute(attrName,namespaceName),this}isSystemLiteralListIdenticalTo(otherNode){if(this.systemLiterals.length!==otherNode.systemLiterals.length)return!1;for(let i=0;i<this.systemLiterals.length;i++)if(this.systemLiterals[i]!==otherNode.systemLiterals[i])return!1;return!0}isIdenticalTo(otherNode){return super.isIdenticalTo(otherNode)&&this.isSystemLiteralListIdenticalTo(otherNode)}stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),`${Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)}<!${this.tagName}${this.stringifyAttributesAndSystemLiterals(params,nodeIndentDepth)}>${params.newlineChar}`}stringifyAttributesAndSystemLiterals(params,nodeIndentDepth){return this.literalAndAttrOrder.map(attrNameOrLiteralIndex=>"string"==typeof attrNameOrLiteralIndex?this.stringifyAttribute(attrNameOrLiteralIndex,this.getAttribute(attrNameOrLiteralIndex)):` "${this.getSystemLiteralAtIndex(attrNameOrLiteralIndex)}"`).join("")}appendSystemLiteralIndexToOrderList(literalIndex){this.removeSystemLiteralIndexFromOrderList(literalIndex),this.literalAndAttrOrder.push(literalIndex)}removeSystemLiteralIndexFromOrderList(literalIndex){const index=this.literalAndAttrOrder.indexOf(literalIndex);-1!==index&&this.literalAndAttrOrder.splice(index,1)}appendAttributeToOrderList(attrNameWithNamespace){this.removeAttributeFromOrderList(attrNameWithNamespace),this.literalAndAttrOrder.push(attrNameWithNamespace)}removeAttributeFromOrderList(attrNameWithNamespace){const index=this.literalAndAttrOrder.indexOf(attrNameWithNamespace);-1!==index&&this.literalAndAttrOrder.splice(index,1)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);exports.ProcessingInstructionNode=class ProcessingInstructionNode extends Node_1.Node{stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),`${Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)}<?${this.tagName}${this.stringifyAttributes(nodeIndentDepth)}?>${params.newlineChar}`}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Node_1=__webpack_require__(13);exports.ContainerNode=class ContainerNode extends Node_1.Node{constructor(){super(...arguments),this.childNodes=[]}getNumberOfChildren(){return this.childNodes.length}getChildAtIndex(index){return this.childNodes[index]}getIndexOfChild(child){return this.childNodes.indexOf(child)}hasChild(child){return-1!==this.getIndexOfChild(child)}insertChildAt(child,index){return Node_1.Node.changeParentNode(child,this),this.childNodes.splice(index,0,child),this}removeChildAt(index){const removedNode=this.childNodes.splice(index,1)[0];return Node_1.Node.removeParentNode(removedNode),this}insertChildBefore(child,referenceChild){if(!this.hasChild(referenceChild))throw new Error("Can not insert child: reference child not found.");return this.insertChildAt(child,this.getIndexOfChild(referenceChild)),this}insertChildAfter(child,referenceChild){if(!this.hasChild(referenceChild))throw new Error("Can not insert child: reference child not found.");return this.insertChildAt(child,this.getIndexOfChild(referenceChild)+1),this}prependChild(child){return this.insertChildAt(child,0),this}appendChild(child){return this.insertChildAt(child,this.getNumberOfChildren()),this}replaceChild(oldChild,newChild){const index=this.getIndexOfChild(oldChild);return this.removeChildAt(index),this.insertChildAt(newChild,index),this}forEachChildNode(fn){this.childNodes.forEach((childNode,index)=>fn(childNode,index))}isSubtreeIdenticalTo(otherNode){if(this.getNumberOfChildren()!==otherNode.getNumberOfChildren())return!1;for(let i=0;i<this.getNumberOfChildren();i++)if(!this.getChildAtIndex(i).isIdenticalTo(otherNode.getChildAtIndex(i)))return!1;return!0}isIdenticalTo(otherNode){return super.isIdenticalTo(otherNode)&&this.isSubtreeIdenticalTo(otherNode)}stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),`${Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)}<${this.tagName}${this.stringifyAttributes(nodeIndentDepth)}>${this.stringifyAllChildNodes(params,nodeIndentDepth)}${Node_1.Node.generateIndentString(params.indentChar,nodeIndentDepth)}</${this.tagName}>${params.newlineChar}`}stringifyAllChildNodes(params,nodeIndentDepth){var xml=params.newlineChar;return this.forEachChildNode(childNode=>{xml+=this.stringifyChildNode(childNode,params,nodeIndentDepth+1)}),xml}stringifyChildNode(childNode,params,nodeIndentDepth){return childNode.stringify(params,nodeIndentDepth)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const ContainerNode_1=__webpack_require__(22);exports.DocumentNode=class DocumentNode extends ContainerNode_1.ContainerNode{stringify(params,nodeIndentDepth){return nodeIndentDepth=Math.max(nodeIndentDepth||0,0),this.stringifyAllChildNodes(params,nodeIndentDepth)}stringifyAllChildNodes(params,nodeIndentDepth){var xml="";return this.forEachChildNode(childNode=>{xml+=this.stringifyChildNode(childNode,params,nodeIndentDepth)}),xml}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const SyntaxErrorCode_1=__webpack_require__(25);exports.SyntaxErrorCode=SyntaxErrorCode_1.SyntaxErrorCode;const SyntaxError_1=__webpack_require__(26);exports.SyntaxError=SyntaxError_1.SyntaxError;const TagCloseMode_1=__webpack_require__(27);exports.TagCloseMode=TagCloseMode_1.TagCloseMode;const TagSyntaxRule_1=__webpack_require__(28);exports.TagSyntaxRule=TagSyntaxRule_1.TagSyntaxRule;const SyntaxRuleSet_1=__webpack_require__(29);exports.SyntaxRuleSet=SyntaxRuleSet_1.SyntaxRuleSet;const NodeFlags_1=__webpack_require__(14);exports.NodeFlags=NodeFlags_1.NodeFlags;const Parser_1=__webpack_require__(30);exports.Parser=Parser_1.Parser;const ruleSet=__webpack_require__(31);exports.ruleSet=ruleSet},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(SyntaxErrorCode){SyntaxErrorCode[SyntaxErrorCode.Unknown=0]="Unknown",SyntaxErrorCode[SyntaxErrorCode.UnexpectedToken=1]="UnexpectedToken",SyntaxErrorCode[SyntaxErrorCode.MissingTagNameAfterNamespacePrefix=2]="MissingTagNameAfterNamespacePrefix",SyntaxErrorCode[SyntaxErrorCode.MissingAttrNameAfterAttrPrefix=3]="MissingAttrNameAfterAttrPrefix",SyntaxErrorCode[SyntaxErrorCode.IllegalNamespacePrefix=4]="IllegalNamespacePrefix",SyntaxErrorCode[SyntaxErrorCode.IllegalSelfClose=5]="IllegalSelfClose",SyntaxErrorCode[SyntaxErrorCode.ExcessCloseTag=6]="ExcessCloseTag",SyntaxErrorCode[SyntaxErrorCode.InvalidTagName=7]="InvalidTagName"}(exports.SyntaxErrorCode||(exports.SyntaxErrorCode={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const SyntaxErrorCode_1=__webpack_require__(25);class SyntaxError extends Error{constructor(errorCode,line,column,source,message){super(message),this.errorCode=errorCode,this.line=line,this.column=column,this.source=source,this.source=this.source||""}static getSyntaxErrorCodeName(errorCode){return SyntaxErrorCode_1.SyntaxErrorCode[errorCode]}getMessage(){return this.message}getErrorCode(){return this.errorCode}getErrorName(){return SyntaxError.getSyntaxErrorCodeName(this.getErrorCode())}getLine(){return this.line}getColumn(){return this.column}toString(){return`syntax error [${this.getErrorCode()} ${this.getErrorName()}] at token '${this.getTokenAt(this.line,this.column)}' ${this.getLine()}, ${this.getColumn()}: ${this.getMessage()}`}getTokenAt(line,column){const sourceLine=this.source.split(/\n/)[line-1];return"string"!=typeof sourceLine?"":sourceLine.split("")[column-1]}}exports.SyntaxError=SyntaxError},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(TagCloseMode){TagCloseMode[TagCloseMode.Tag=1]="Tag",TagCloseMode[TagCloseMode.SelfClose=2]="SelfClose",TagCloseMode[TagCloseMode.Void=4]="Void"}(exports.TagCloseMode||(exports.TagCloseMode={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class TagSyntaxRule{constructor(tagNames){this.tagNames=tagNames}static createForTagName(tagName){return new TagSyntaxRule([tagName])}static createForTagNames(...tagNames){return new TagSyntaxRule(tagNames.filter((tagName,index,array)=>array.indexOf(tagName)===index))}getTagNames(){return[].concat(this.tagNames)}appliesToTagName(tagName){return-1!==this.tagNames.indexOf(tagName)}getCloseMode(){return this.closeMode}setCloseMode(mode){return this.closeMode=mode,this}}exports.TagSyntaxRule=TagSyntaxRule},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class SyntaxRuleSet{constructor(){this.tagSyntaxRules=[]}static createInstance(){return new this}static isSyntaxRuleSetClass(candidate){return"function"==typeof candidate&&candidate._syntaxRuleSetBrand_===SyntaxRuleSet._syntaxRuleSetBrand_}hasTagSyntaxRule(rule){return-1!==this.tagSyntaxRules.indexOf(rule)}getAllTagSyntaxRules(){return[].concat(this.tagSyntaxRules)}addTagSyntaxRule(rule){return this.hasTagSyntaxRule(rule)||this.tagSyntaxRules.push(rule),this}addTagSyntaxRules(...rules){return rules.forEach(rule=>this.addTagSyntaxRule(rule)),this}}SyntaxRuleSet._syntaxRuleSetBrand_=Math.random(),exports.SyntaxRuleSet=SyntaxRuleSet},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const ast=__webpack_require__(11),Node_1=__webpack_require__(13),SelfClosingNode_1=__webpack_require__(15),DocumentNode_1=__webpack_require__(23),ContainerNode_1=__webpack_require__(22),VoidNode_1=__webpack_require__(16),SyntaxErrorCode_1=__webpack_require__(25),SyntaxError_1=__webpack_require__(26),TagCloseMode_1=__webpack_require__(27),TagSyntaxRule_1=__webpack_require__(28),SyntaxRuleSet_1=__webpack_require__(29),NodeFlags_1=__webpack_require__(14);class Parser{constructor(stringToParse){this.stringToParse=stringToParse,this.defaultTagSyntaxRule=Parser.createDefaultTagSyntaxRule(),this.tagSyntaxRules={},this.ast=new DocumentNode_1.DocumentNode,this.currentContainerNode=this.getAst(),this.currentTokenIndex=0}static createForXmlString(stringToParse){return new Parser(stringToParse)}static parseString(stringToParse,ruleSet){return __awaiter(this,void 0,void 0,function*(){const parser=Parser.createForXmlString(stringToParse);return(ruleSet instanceof SyntaxRuleSet_1.SyntaxRuleSet||SyntaxRuleSet_1.SyntaxRuleSet.isSyntaxRuleSetClass(ruleSet))&&parser.applySyntaxRuleSet(ruleSet),parser.parseComplete(),parser})}static parseStringToAst(stringToParse,ruleSet){return __awaiter(this,void 0,void 0,function*(){return(yield Parser.parseString(stringToParse,ruleSet)).getAst()})}getDefaultTagSyntaxRule(){return this.defaultTagSyntaxRule}setDefaultTagSyntaxRule(rule){this.defaultTagSyntaxRule=rule}getTagSyntaxRuleForTagName(tagName){return this.tagSyntaxRules[tagName]||void 0}hasTagSyntaxRuleForTagName(tagName){const rule=this.getTagSyntaxRuleForTagName(tagName);return"object"==typeof rule&&null!==rule}addTagSyntaxRule(rule){return rule.getTagNames().forEach(tagName=>{this.tagSyntaxRules[tagName]=rule}),this}addTagSyntaxRules(...rules){return rules.forEach(rule=>this.addTagSyntaxRule(rule)),this}removeTagSyntaxRuleForTagName(tagName){return this.tagSyntaxRules[tagName]=void 0,this}removeTagSyntaxRulesForTagNames(tagNames){return tagNames.forEach(tagName=>this.removeTagSyntaxRuleForTagName(tagName)),this}applySyntaxRuleSet(ruleSet){return SyntaxRuleSet_1.SyntaxRuleSet.isSyntaxRuleSetClass(ruleSet)&&(ruleSet=ruleSet.createInstance()),this.addTagSyntaxRules(...ruleSet.getAllTagSyntaxRules()),this}getAst(){return this.ast}parseComplete(){if(!(this.stringToParse.length<1))for(;!this.isAtEndOfInput();)this.parseFromCurrentToken()}getCurrentLine(){const tokenMatrix=this.getTokenMatrix();return tokenMatrix[this.getCurrentTokenIndex()]?tokenMatrix[this.getCurrentTokenIndex()].line:0===this.getCurrentTokenIndex()?1:void 0}getCurrentColumn(){const tokenMatrix=this.getTokenMatrix();return tokenMatrix[this.getCurrentTokenIndex()]?tokenMatrix[this.getCurrentTokenIndex()].column:0===this.getCurrentTokenIndex()?1:void 0}getCurrentTokenIndex(){return this.currentTokenIndex}isAtEndOfInput(){return this.getCurrentTokenIndex()>=this.stringToParse.length}getTokenAtIndex(index){return this.stringToParse[index]}getCurrentToken(){return this.getTokenAtIndex(this.getCurrentTokenIndex())}getTokenRange(startIndex,endIndex){return this.stringToParse.slice(startIndex,endIndex)}getTokenRangeStartingAt(startIndex,length){return this.stringToParse.slice(startIndex,startIndex+length)}getNextToken(){return this.getTokenAtIndex(this.getCurrentTokenIndex()+1)}getPreviousToken(){return this.getTokenAtIndex(this.getCurrentTokenIndex()-1)}findFirstOccurenceOfTokenAfterIndex(token,startIndex){return this.stringToParse.indexOf(token[0],startIndex)}doesTokenOccurBeforeNextOccurenceOfOtherToken(token,otherToken,startIndex){const tokenIndex=this.findFirstOccurenceOfTokenAfterIndex(token,startIndex),otherTokenIndex=this.findFirstOccurenceOfTokenAfterIndex(otherToken,startIndex);return!(tokenIndex<0||otherTokenIndex<0)&&tokenIndex<otherTokenIndex}getCurrentContainerNode(){return this.currentContainerNode}descendInto(containerNode){this.currentContainerNode=containerNode}ascend(){this.currentContainerNode.parentNode instanceof ContainerNode_1.ContainerNode||this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.Unknown,"can not ascend: current containing node has no parent node")),this.currentContainerNode=this.currentContainerNode.parentNode}createSyntaxError(errorCode,line,column,message){return new SyntaxError_1.SyntaxError(errorCode,line,column,this.stringToParse,message)}createSyntaxErrorAtCurrentToken(errorCode,message){return this.createSyntaxError(errorCode,this.getCurrentLine(),this.getCurrentColumn(),message)}createUnexpectedTokenSyntaxErrorAtCurrentToken(message){return message=message||"token can not be parsed",this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.UnexpectedToken,message)}raiseError(error){throw error}static isSingularCloseMode(closeMode){return closeMode in TagCloseMode_1.TagCloseMode}static createDefaultTagSyntaxRule(){const rule=TagSyntaxRule_1.TagSyntaxRule.createForTagName(void 0);return rule.setCloseMode(TagCloseMode_1.TagCloseMode.Tag|TagCloseMode_1.TagCloseMode.SelfClose),rule}getOverrideOrDefaultTagSyntaxRuleForTagName(tagName){return this.getTagSyntaxRuleForTagName(tagName)||this.getDefaultTagSyntaxRule()}getAllowedTagCloseModesForTagName(tagName){return this.getOverrideOrDefaultTagSyntaxRuleForTagName(tagName).getCloseMode()}isCloseModeAllowedForTagName(tagName,closeMode){if(!Parser.isSingularCloseMode(closeMode))throw new Error("Rule lookup failed: tag close mode must not be a combination of close modes.");return(this.getAllowedTagCloseModesForTagName(tagName)&closeMode)===closeMode}static isAlphabeticToken(token){return/[a-z]/i.test(token[0])}static isNumericToken(token){return/[0-9]/i.test(token[0])}static isWhitespaceToken(token){return" "===(token=token[0])||"\t"===token||"\r"===token||"\n"===token}static isTokenLegalInTagNameOrTagNameNamespacePrefix(token){return Parser.isAlphabeticToken(token)||Parser.isNumericToken(token)||"-"===token[0]||"_"===token[0]||"."===token[0]}static isTokenLegalInAttributeNameOrAttributeNameNameNamespacePrefix(token){return Parser.isAlphabeticToken(token)||Parser.isNumericToken(token)||"-"===token[0]||"_"===token[0]}moveByNumberOfTokens(numberOfTokens){this.currentTokenIndex+=numberOfTokens}goBackByNumberOfTokens(numberOfTokens){this.moveByNumberOfTokens(0-Math.abs(numberOfTokens))}goBackToPreviousToken(){this.goBackByNumberOfTokens(1)}advanceByNumberOfTokens(numberOfTokens){this.moveByNumberOfTokens(Math.abs(numberOfTokens))}advanceToNextToken(){this.advanceByNumberOfTokens(1)}parseFromCurrentToken(){if(!this.isAtEndOfInput())switch(!0){default:this.parseIntoNewTextNode();break;case"string"!=typeof this.getCurrentToken():case Parser.isWhitespaceToken(this.getCurrentToken())||"\r"===this.getCurrentToken()||"\n"===this.getCurrentToken():this.advanceToNextToken();break;case"<"===this.getCurrentToken():this.parseFromOpenAngleBracket()}}parseFromOpenAngleBracket(){"!"===this.getNextToken()||"?"===this.getNextToken()||!this.doesTokenOccurBeforeNextOccurenceOfOtherToken("<",">",this.getCurrentTokenIndex()+1)||this.doesTokenOccurBeforeNextOccurenceOfOtherToken('"',"<",this.getCurrentTokenIndex()+1)||this.doesTokenOccurBeforeNextOccurenceOfOtherToken("'","<",this.getCurrentTokenIndex()+1)?this.parseFromBeginningOfTag():this.parseIntoNewTextNode()}parseIntoNewTextNode(){const textNode=new ast.TextNode;for(textNode.content="",this.getCurrentContainerNode().appendChild(textNode);Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();for(;!this.isAtEndOfInput()&&("<"!==this.getCurrentToken()||this.doesTokenOccurBeforeNextOccurenceOfOtherToken("<",">",this.getCurrentTokenIndex()+1));)textNode.content+=this.getCurrentToken(),this.advanceToNextToken()}parseFromBeginningOfTag(){switch(!0){default:this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected exclamation mark, question mark or alphabetic tag name"));break;case Parser.isTokenLegalInTagNameOrTagNameNamespacePrefix(this.getNextToken()):this.parseFromBeginningOfNormalNode();break;case"</"===this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2):this.parseFromBeginningOfCloseTag();break;case"!"===this.getNextToken():switch(!0){default:this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected declaration opener or comment node"));break;case"[CDATA["===this.getTokenRangeStartingAt(this.getCurrentTokenIndex()+2,7):this.parseFromBeginningOfCDataSectionNode();break;case Parser.isAlphabeticToken(this.getTokenAtIndex(this.getCurrentTokenIndex()+2)):this.parseFromBeginningOfDeclarationOpenerNode();break;case"--"===this.getTokenRangeStartingAt(this.getCurrentTokenIndex()+2,2):this.parseFromBeginningOfCommentNode()}break;case"?"===this.getNextToken():this.parseFromBeginningOfProcessingInstructionNode()}}parseFromBeginningOfNormalNode(){Parser.isTokenLegalInTagNameOrTagNameNamespacePrefix(this.getNextToken())||this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken(`expected beginning of tag name, got '${this.getNextToken()}'`));const node=new SelfClosingNode_1.SelfClosingNode;this.getCurrentContainerNode().appendChild(node),this.advanceToNextToken(),"."===this.getCurrentToken()&&this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.InvalidTagName,`expected beginning of tag name, got '${this.getCurrentToken()}'`)),this.parseCompleteOpeningTagInto(node,!0,!1)}findUnclosedNodeMatchingTagName(tagNameInfo){var containerNode=this.getCurrentContainerNode();do{if(!(containerNode.parserFlags&NodeFlags_1.NodeFlags.Closed||containerNode.namespacePrefix!==tagNameInfo.namespacePrefix||containerNode.tagName!==tagNameInfo.tagName))return containerNode}while((containerNode=containerNode.parentNode)&&containerNode.parentNode instanceof Node_1.Node)}parseFromBeginningOfCloseTag(){if("</"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2)){const message=`expected beginning of close tag (</...), got '${this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2)}'`;this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken(message))}this.advanceByNumberOfTokens(2);const tagNameInfo=this.parseTagName();this.findUnclosedNodeMatchingTagName(tagNameInfo)instanceof ContainerNode_1.ContainerNode||this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.ExcessCloseTag,`close tag '${tagNameInfo.tagName}' has no open tag`)),">"!==this.getCurrentToken()&&this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken(`expected end of close tag, got '${this.getCurrentToken()}'`)),this.advanceToNextToken(),this.ascend()}parseFromBeginningOfDeclarationOpenerNode(){"<!"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2)&&this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected beginning of declaration opener (<!)"));const mdoNode=new ast.DeclarationOpenerNode;this.getCurrentContainerNode().appendChild(mdoNode),this.advanceByNumberOfTokens(2),this.parseCompleteOpeningTagInto(mdoNode,!1,!0)}parseFromBeginningOfProcessingInstructionNode(){"<?"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2)&&this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected beginning of processing instruction (<?)"));const piNode=new ast.ProcessingInstructionNode;this.getCurrentContainerNode().appendChild(piNode),this.advanceByNumberOfTokens(2),this.parseCompleteOpeningTagInto(piNode,!1,!1)}parseFromBeginningOfCDataSectionNode(){"<![CDATA["!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),9)&&this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected beginning of CDATA section (<![CDATA[)"));const cdataNode=new ast.CDataSectionNode;for(this.getCurrentContainerNode().appendChild(cdataNode),this.advanceByNumberOfTokens(9),cdataNode.content="";"]]>"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),3);)cdataNode.content+=this.getCurrentToken(),this.advanceToNextToken();this.advanceByNumberOfTokens(3)}parseFromBeginningOfCommentNode(){"\x3c!--"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),4)&&this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected beginning of comment (\x3c!--)"));const commentNode=new ast.CommentNode;for(this.getCurrentContainerNode().appendChild(commentNode),this.advanceByNumberOfTokens(4),commentNode.content="";"--\x3e"!==this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),3);)commentNode.content+=this.getCurrentToken(),this.advanceToNextToken();this.advanceByNumberOfTokens(3)}static createContainerNodeFromOtherNode(node){const containerNode=new ContainerNode_1.ContainerNode;return containerNode.namespacePrefix=node.namespacePrefix,containerNode.tagName=node.tagName,node.getAllAttributeNames().forEach(attrName=>containerNode.setAttribute(attrName,node.getAttribute(attrName))),containerNode}static createVoidNodeFromOtherNode(node){const voidNode=new VoidNode_1.VoidNode;return voidNode.namespacePrefix=node.namespacePrefix,voidNode.tagName=node.tagName,node.getAllAttributeNames().forEach(attrName=>voidNode.setAttribute(attrName,node.getAttribute(attrName))),voidNode}parseCompleteOpeningTagInto(node,allowDescendingIntoNewContainerNode,allowSystemLiterals){for(this.parseTagNameInto(node),"?"!==this.getCurrentToken()&&">"!==this.getCurrentToken()&&this.parseAttributeListInto(node,allowSystemLiterals);Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();switch(!0){default:this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected end of opening tag"));break;case"/>"===this.getTokenRangeStartingAt(this.getCurrentTokenIndex(),2):return this.isCloseModeAllowedForTagName(node.tagName,TagCloseMode_1.TagCloseMode.SelfClose)||this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.IllegalSelfClose,`tag '${node.tagName}' must not self-close`)),node.parserFlags|=NodeFlags_1.NodeFlags.SelfClosing,void this.advanceByNumberOfTokens(2);case"?"===this.getCurrentToken():this.advanceToNextToken();case">"===this.getCurrentToken():this.parseEndOfNonSelfClosingOpeningTag(node,allowDescendingIntoNewContainerNode),this.advanceToNextToken()}}parseEndOfNonSelfClosingOpeningTag(node,allowDescendingIntoNewContainerNode){if(node instanceof SelfClosingNode_1.SelfClosingNode)if(this.isCloseModeAllowedForTagName(node.tagName,TagCloseMode_1.TagCloseMode.Void)){const voidNode=Parser.createVoidNodeFromOtherNode(node);node.parentNode.replaceChild(node,voidNode),(node=voidNode).parserFlags|=NodeFlags_1.NodeFlags.Void}else{const containerNode=Parser.createContainerNodeFromOtherNode(node);node.parentNode.replaceChild(node,containerNode),node.parserFlags|=NodeFlags_1.NodeFlags.Opened,allowDescendingIntoNewContainerNode&&this.descendInto(containerNode)}}parseTagName(){for(var colonSeen=!1,nameStash="",tagNameInfo={namespacePrefix:void 0,tagName:void 0};Parser.isTokenLegalInTagNameOrTagNameNamespacePrefix(this.getCurrentToken())||":"===this.getCurrentToken();){if(":"===this.getCurrentToken()&&(colonSeen&&this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.IllegalNamespacePrefix,"illegal multiple namespace prefix (multiple colons in tag name)")),colonSeen=!0,tagNameInfo.namespacePrefix=nameStash,nameStash="",this.advanceToNextToken(),!Parser.isAlphabeticToken(this.getCurrentToken())))return void this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.MissingTagNameAfterNamespacePrefix,"namespace prefix must be followed by a tag name"));nameStash+=this.getCurrentToken(),this.advanceToNextToken()}return tagNameInfo.tagName=nameStash,tagNameInfo}parseTagNameInto(node){const tagNameInfo=this.parseTagName();node.namespacePrefix=tagNameInfo.namespacePrefix,node.tagName=tagNameInfo.tagName}parseAttributeListInto(node,allowLiterals){for(Parser.isWhitespaceToken(this.getCurrentToken())||"/"===this.getCurrentToken()||">"===this.getCurrentToken()||allowLiterals||'"'!==this.getCurrentToken()||this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("expected whitespace or end of opening tag"));Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();if(Parser.isAlphabeticToken(this.getCurrentToken())||allowLiterals||'"'===this.getCurrentToken())for(;">"!==this.getCurrentToken()&&"/"!==this.getCurrentToken()&&"?"!==this.getCurrentToken();)if('"'===this.getCurrentToken())allowLiterals||this.raiseError(this.createUnexpectedTokenSyntaxErrorAtCurrentToken("system literal not allowed on this node")),node.appendToSystemLiteralList(this.parseLiteral());else{let attrInfo=this.parseAttribute();if(""===attrInfo.name)continue;for(node.setAttribute(attrInfo.name,attrInfo.value);Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken()}}parseLiteral(){for(var value="";Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();const valueQuoteCharacter=this.getCurrentToken();for(;!this.isAtEndOfInput()&&(this.advanceToNextToken(),this.getCurrentToken()!==valueQuoteCharacter);)value+=this.getCurrentToken();return this.advanceToNextToken(),value}parseAttribute(){for(var value,valueQuoteCharacter,name="",colonSeen=!1,getAttrInfo=()=>({name:name,value:value});Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();for(;Parser.isTokenLegalInAttributeNameOrAttributeNameNameNamespacePrefix(this.getCurrentToken())||":"===this.getCurrentToken();){if(":"===this.getCurrentToken()&&(colonSeen&&this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.IllegalNamespacePrefix,"illegal multiple namespace prefix (multiple colons in tag name)")),colonSeen=!0,!Parser.isAlphabeticToken(this.getNextToken())))return void this.raiseError(this.createSyntaxErrorAtCurrentToken(SyntaxErrorCode_1.SyntaxErrorCode.MissingTagNameAfterNamespacePrefix,"namespace prefix must be followed by a tag name"));name+=this.getCurrentToken(),this.advanceToNextToken()}for(;Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();if("="!==this.getCurrentToken())return getAttrInfo();if(this.advanceToNextToken(),Parser.isWhitespaceToken(this.getCurrentToken())||'"'===this.getCurrentToken()||"'"===this.getCurrentToken()){for(;Parser.isWhitespaceToken(this.getCurrentToken());)this.advanceToNextToken();if('"'!==this.getCurrentToken()&&"'"!==this.getCurrentToken())return getAttrInfo();valueQuoteCharacter=this.getCurrentToken()}for(value="";!this.isAtEndOfInput();){if(this.advanceToNextToken(),this.getCurrentToken()===valueQuoteCharacter){this.advanceToNextToken();break}value+=this.getCurrentToken()}return getAttrInfo()}getTokenMatrix(){return"object"==typeof this.tokenMatrix&&null!==this.tokenMatrix||this.createTokenMatrix(),this.tokenMatrix}createTokenMatrix(){var line=1,column=0;this.tokenMatrix=new Array(this.stringToParse.length);for(let i=0;i<this.stringToParse.length;i++){column+=1;const currentToken=this.stringToParse[i];this.tokenMatrix[i]={line:line,column:column},"\n"===currentToken&&(line+=1,column=0)}}}exports.Parser=Parser},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Html5_1=__webpack_require__(32);exports.Html5=Html5_1.Html5},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const TagCloseMode_1=__webpack_require__(27),TagSyntaxRule_1=__webpack_require__(28),SyntaxRuleSet_1=__webpack_require__(29);class Html5 extends SyntaxRuleSet_1.SyntaxRuleSet{static get Loose(){return class Html5Loose extends Html5{constructor(){super(!0)}}}static get Strict(){return class Html5Strict extends Html5{constructor(){super(!1)}}}constructor(allowVoidElementsToSelfClose){super(),void 0===allowVoidElementsToSelfClose&&(allowVoidElementsToSelfClose=!0);const voidTagSyntaxRule=TagSyntaxRule_1.TagSyntaxRule.createForTagNames("area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr");allowVoidElementsToSelfClose?voidTagSyntaxRule.setCloseMode(TagCloseMode_1.TagCloseMode.Void|TagCloseMode_1.TagCloseMode.SelfClose):voidTagSyntaxRule.setCloseMode(TagCloseMode_1.TagCloseMode.Void),this.addTagSyntaxRule(voidTagSyntaxRule)}}exports.Html5=Html5},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const Parser_1=__webpack_require__(30);exports.Compiler=class Compiler{static parseXml(xmlString,ruleSet){return __awaiter(this,void 0,void 0,function*(){return Parser_1.Parser.parseString(xmlString,ruleSet)})}static parseXmlToAst(xmlString,ruleSet){return __awaiter(this,void 0,void 0,function*(){return Parser_1.Parser.parseStringToAst(xmlString,ruleSet)})}static formatXmlString(xmlString,formattingOptions,ruleSet){return __awaiter(this,void 0,void 0,function*(){return(yield Parser_1.Parser.parseStringToAst(xmlString,ruleSet)).toFormattedString(formattingOptions)})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";function load(name){return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest,url=name;xhr.open("GET",url),xhr.overrideMimeType("application/json"),xhr.onload=(()=>{xhr.status<400?resolve(JSON.parse(xhr.responseText)):reject(xhr.statusText)}),xhr.onerror=reject,xhr.send()})}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",function(){return load})}])});